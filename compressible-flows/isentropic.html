
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Isentropic, variable-area flows &#8212; Gas Dynamics notes</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet" />
  <link href="../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>window.MathJax = {"TeX": {"Macros": {"vector": ["\\vec{#1}", 1], "uvec": ["\\hat{#1}", 1], "mag": ["\\lVert#1\\rVert", 1], "cross": "\\times", "unit": ["#1~\\mathrm{#2}", 2]}}, "options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Nozzles (part I)" href="nozzles-part1.html" />
    <link rel="prev" title="Introduction to compressible flow" href="intro-compressible-flow.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.jpg" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Gas Dynamics notes</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../intro.html">
   Gas Dynamics notes
  </a>
 </li>
</ul>
<p class="caption" role="heading">
 <span class="caption-text">
  Introduction and review
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../intro/review-thermo.html">
   Review of thermodynamics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../intro/control-volume-analysis.html">
   Control volume analysis
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../intro/stagnation.html">
   Stagnation properties
  </a>
 </li>
</ul>
<p class="caption" role="heading">
 <span class="caption-text">
  Compressible flows
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="intro-compressible-flow.html">
   Introduction to compressible flow
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Isentropic, variable-area flows
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="nozzles-part1.html">
   Nozzles (part I)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="normal-shocks.html">
   Normal shock waves
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="oblique-shocks.html">
   Oblique shock waves
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="prandtl-meyer.html">
   Prandtlâ€“Meyer flows
  </a>
 </li>
</ul>
<p class="caption" role="heading">
 <span class="caption-text">
  Reference
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../zbibliography.html">
   Bibliography
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/compressible-flows/isentropic.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/kyleniemeyer/gas-dynamics-notes"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/kyleniemeyer/gas-dynamics-notes/issues/new?title=Issue%20on%20page%20%2Fcompressible-flows/isentropic.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        <a class="edit-button" href="https://github.com/kyleniemeyer/gas-dynamics-notes/edit/main/compressible-flows/isentropic.ipynb"><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Edit this page"><i class="fas fa-pencil-alt"></i>suggest edit</button></a>
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/kyleniemeyer/gas-dynamics-notes/main?urlpath=tree/compressible-flows/isentropic.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#varying-area-adiabatic-flows">
   Varying-area adiabatic flows
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#equations-for-perfect-gases">
   Equations for perfect gases
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#sonic-reference-state">
   Sonic reference state
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#isentropic-relations">
   Isentropic relations
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#example-isentropic-flow-problem">
   Example: isentropic flow problem
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#option-1-using-tables">
     Option 1: using tables
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#option-2-solving-the-equation">
     Option 2: solving the equation
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#option-3-solving-the-full-equation">
     Option 3: solving the full equation
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#example-isentropic-flow-using-matlab">
   Example: isentropic flow (using Matlab)
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#option-1-using-the-tables">
     Option 1: using the tables
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Option 2: solving the equation
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id2">
     Option 3: solving the full equation
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="isentropic-variable-area-flows">
<h1>Isentropic, variable-area flows<a class="headerlink" href="#isentropic-variable-area-flows" title="Permalink to this headline">Â¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Necessary modules to solve problems</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">root_scalar</span>

<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># these lines are only for helping improve the display</span>
<span class="kn">import</span> <span class="nn">matplotlib_inline.backend_inline</span>
<span class="n">matplotlib_inline</span><span class="o">.</span><span class="n">backend_inline</span><span class="o">.</span><span class="n">set_matplotlib_formats</span><span class="p">(</span><span class="s1">&#39;pdf&#39;</span><span class="p">,</span> <span class="s1">&#39;png&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.dpi&#39;</span><span class="p">]</span><span class="o">=</span> <span class="mi">150</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;savefig.dpi&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">150</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="varying-area-adiabatic-flows">
<h2>Varying-area adiabatic flows<a class="headerlink" href="#varying-area-adiabatic-flows" title="Permalink to this headline">Â¶</a></h2>
<p>Area change is one of the important factors that can adjust flow properties
in compressible flow systems. (The others are friction and heat transfer, which
we will cover briefly later.)</p>
<p>For now, letâ€™s proceed to analyze flows with the following conditions/assumptions:</p>
<ul class="simple">
<li><p>steady, one-dimensional flow</p></li>
<li><p>adiabatic: <span class="math notranslate nohighlight">\( \delta q = 0 \)</span>, <span class="math notranslate nohighlight">\( d s_e = 0\)</span></p></li>
<li><p>no shaft work: <span class="math notranslate nohighlight">\( \delta w_s = 0 \)</span></p></li>
<li><p>no or negligible change in potential energy: <span class="math notranslate nohighlight">\( dz = 0 \)</span></p></li>
<li><p>no losses (i.e., reversible): <span class="math notranslate nohighlight">\(d s_i = 0\)</span></p></li>
</ul>
<p>As a result of the flow being adiabatic and reversible, it is also isentropic: <span class="math notranslate nohighlight">\(ds = 0\)</span>.</p>
<p>Our goal is now to see how changes in pressure, density, and velocity relate with changing area.</p>
<p>Starting with the energy equation, apply our conditions:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\delta q = \delta w_s + dh + \frac{dV^2}{2} + g dz \\
dh = -V dV
\end{split}\]</div>
<p>We also have our thermodynamic relationships derived from Gibbsâ€™ identities:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
T ds = dh - \frac{dp}{\rho} \\
dh = \frac{dp}{\rho}
\end{split}\]</div>
<p>Combined together, we have</p>
<div class="math notranslate nohighlight">
\[
dV = - \frac{dp}{\rho V} \;.
\]</div>
<p>Substituting this, and the speed of sound (<span class="math notranslate nohighlight">\( dp = a^2 d\rho \)</span>)
into the continuity equation:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
0 &amp;= \frac{d\rho}{\rho} + \frac{dA}{A} + \frac{dA}{A} \\
\frac{dp}{\rho} &amp;= V^2 \left( \frac{d\rho}{\rho} + \frac{dA}{A} \right) \\
\frac{d\rho}{\rho} &amp;= M^2 \left( \frac{d\rho}{\rho} + \frac{dA}{A} \right)
\end{align*}\]</div>
<p>we obtain a relationship between area change and density change:</p>
<div class="math notranslate nohighlight" id="equation-eq-density">
<span class="eqno">(9)<a class="headerlink" href="#equation-eq-density" title="Permalink to this equation">Â¶</a></span>\[
\frac{d\rho}{\rho} = \left( \frac{M^2}{1-M^2} \right) \frac{dA}{A} \;.
\]</div>
<p>Substituting this back into the continuity equation, we obtain a relationship between area change and velocity change:</p>
<div class="math notranslate nohighlight" id="equation-eq-velocity">
<span class="eqno">(10)<a class="headerlink" href="#equation-eq-velocity" title="Permalink to this equation">Â¶</a></span>\[
\frac{dV}{V} = -\left( \frac{1}{1-M^2} \right) \frac{dA}{A} \;.
\]</div>
<p>And, finally, recalling that <span class="math notranslate nohighlight">\( dV = -dp/\rho V \)</span>, we substitute that into Equation <a class="reference internal" href="#equation-eq-velocity">(10)</a> to get a relationsihp between area change and pressure change:</p>
<div class="math notranslate nohighlight" id="equation-eq-pressure">
<span class="eqno">(11)<a class="headerlink" href="#equation-eq-pressure" title="Permalink to this equation">Â¶</a></span>\[
dp = \rho V^2 \left( \frac{1}{1-M^2} \right) \frac{dA}{A} \;.
\]</div>
<p>If we focus on situations where the pressure is decreasing (<span class="math notranslate nohighlight">\( dp &lt; 0 \)</span>), going from a high-pressure reservoir to a low-pressure receiver, we can examine how changes in the other properties must occur.</p>
<p>Examining Equation <a class="reference internal" href="#equation-eq-pressure">(11)</a>, we see that <span class="math notranslate nohighlight">\( dp &lt; 0 \)</span> results in either a positive or negative area change for the subsonic and supersonic regimes:</p>
<div class="math notranslate nohighlight">
\[
(-) = \frac{1}{1-M^2} \frac{dA}{A} \;,
\]</div>
<p>so if <span class="math notranslate nohighlight">\( M &lt; 1 \)</span> then <span class="math notranslate nohighlight">\( dA &lt; 0 \)</span>, and if <span class="math notranslate nohighlight">\( M &gt; 1 \)</span> then <span class="math notranslate nohighlight">\( dA &gt; 0 \)</span>.
Using Equations <a class="reference internal" href="#equation-eq-density">(9)</a> and <a class="reference internal" href="#equation-eq-velocity">(10)</a> we can see how changes in density and velocity occur in the different regimes as well:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{gather*}
M &lt; 1: \quad \frac{d\rho}{\rho} = (+)(-) \rightarrow d\rho &lt; 0 \\
M &gt; 1: \quad \frac{d\rho}{\rho} = (-)(+) \rightarrow d\rho &lt; 0
\end{gather*}\]</div>
<p>and</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{gather*}
M &lt; 1: \quad \frac{dV}{V} = -(+)(-) \rightarrow dV &gt; 0 \\
M &gt; 1: \quad \frac{dV}{V} = -(-)(+) \rightarrow dV &gt; 0
\end{gather*}\]</div>
<p>In summary, for decreasing pressure (<span class="math notranslate nohighlight">\( dp &lt; 0 \)</span>), we have:</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="text-align:left head"><p>property</p></th>
<th class="text-align:center head"><p><span class="math notranslate nohighlight">\( M &lt; 1 \)</span></p></th>
<th class="text-align:center head"><p><span class="math notranslate nohighlight">\( M &gt; 1 \)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-align:left"><p><span class="math notranslate nohighlight">\( A \)</span></p></td>
<td class="text-align:center"><p>â†“</p></td>
<td class="text-align:center"><p>â†‘</p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p><span class="math notranslate nohighlight">\( \rho \)</span></p></td>
<td class="text-align:center"><p>â†“</p></td>
<td class="text-align:center"><p>â†“</p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p><span class="math notranslate nohighlight">\( V \)</span></p></td>
<td class="text-align:center"><p>â†‘</p></td>
<td class="text-align:center"><p>â†‘</p></td>
</tr>
</tbody>
</table>
<p>This particular example shows how properties change in a <strong>nozzle</strong>, which converts pressure/enthalpy to kinetic energy. We can see that a subsonic nozzle has a converging shape (i.e., has a decreasing area) while a supersonic nozzle is diverging (with an increasing area).</p>
<p>In contrast, a <strong>diffuser</strong> converts kinetic energy into enthalpy/pressure, and is associated with increasing pressure (<span class="math notranslate nohighlight">\( dp &gt; 0 \)</span>). A subsonic diffuser is diverging, while a supersonic diffuser is converging.</p>
<p>For propulsion applications, when we need to accelerate a gas from low speed to supersonic speeds, we will need a <strong>converging-diverging nozzle</strong>. This will be the focus of deeper analysis later.</p>
</div>
<div class="section" id="equations-for-perfect-gases">
<h2>Equations for perfect gases<a class="headerlink" href="#equations-for-perfect-gases" title="Permalink to this headline">Â¶</a></h2>
<p>Using our governing equations, we can generate working equations that apply to more-general flows of perfect/ideal gases, where losses (i.e., irreversibilities) may be present.</p>
<p>The flow assumptions are:</p>
<ul class="simple">
<li><p>steady, one-dimensional flow</p></li>
<li><p>adiabatic</p></li>
<li><p>no shaft work</p></li>
<li><p>perfect/ideal gas</p></li>
<li><p>no, or negligible, potential energy changes</p></li>
</ul>
<p>Our goal is to find relations between properties at two points in the flow that are only a function of the gas, Mach numbers at both locations, and entropy change between the two locations: <span class="math notranslate nohighlight">\( f \left( M_1, M_2, \gamma, \delta s \right) \)</span>.</p>
<p>Start with the continuity equation applied to a control volume, with flow entering at location 1 and leaving at location 2:</p>
<div class="math notranslate nohighlight" id="equation-eq-continuity-area-ratio">
<span class="eqno">(12)<a class="headerlink" href="#equation-eq-continuity-area-ratio" title="Permalink to this equation">Â¶</a></span>\[\begin{split}
\begin{gather*}
\rho_1 A_1 V_1 = \rho_2 A_2 V_2 \\
\frac{A_2}{A_1} = \frac{\rho_1 V_1}{\rho_2 V_2} = \frac{p_1}{p_2} \frac{M_1}{M_2} \left( \frac{T_2}{T_1} \right)^{1/2} \;,
\end{gather*}
\end{split}\]</div>
<p>where we got the final relation by using the ideal gas law (<span class="math notranslate nohighlight">\( p = \rho R T \)</span>), Mach number definition (<span class="math notranslate nohighlight">\( V = M a \)</span>), and speed of sound expression in an ideal gas (<span class="math notranslate nohighlight">\( a^2 = \gamma R T \)</span>).</p>
<p>We can simplify this expression even further by finding ways to express the pressure and temperature ratios as functions of the Mach numbers and gas properties.</p>
<p>For the temperature ratio, we can use conservation of energy and our expression for stagnation temperature:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{gather*}
h_{t1} + q = h_{t2} + w_s \\
\rightarrow T_{t1} = T_{t2} \\
T_t = T \left(1 + \frac{\gamma - 1}{2} M^2 \right) \\
\end{gather*}
\end{split}\]</div>
<div class="math notranslate nohighlight" id="equation-eq-temperature-ratio">
<span class="eqno">(13)<a class="headerlink" href="#equation-eq-temperature-ratio" title="Permalink to this equation">Â¶</a></span>\[
\therefore \frac{T_2}{T_1} = \frac{1 + \frac{\gamma-1}{2} M_1^2}{1 + \frac{\gamma-1}{2} M_2^2}
\]</div>
<p>For pressure, recall our relationship for the ratio of stagnation pressures between two locations:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{gather*}
\frac{p_{t2}}{p_{t1}} = e^{-\Delta s / R} \\
p_t = p \left(1 + \frac{\gamma - 1}{2} M^2 \right)^{\gamma / (\gamma-1)} \\
\frac{p_{t2}}{p_{t1}} = \frac{p_2}{p_1} \left[ \frac{1 + \frac{\gamma - 1}{2} M_2^2}{1 + \frac{\gamma - 1}{2} M_1^2} \right]^{\gamma / (\gamma-1)} = e^{-\Delta s / R}
\end{gather*}
\end{split}\]</div>
<div class="math notranslate nohighlight" id="equation-eq-pressure-ratio">
<span class="eqno">(14)<a class="headerlink" href="#equation-eq-pressure-ratio" title="Permalink to this equation">Â¶</a></span>\[
\therefore \frac{p_1}{p_2} = \left[ \frac{1 + \frac{\gamma - 1}{2} M_2^2}{1 + \frac{\gamma - 1}{2} M_1^2} \right]^{\gamma / (\gamma-1)} e^{\Delta s / R} \;.
\]</div>
<p>Putting the expressions for <span class="math notranslate nohighlight">\( \frac{p_1}{p_2} \)</span> and <span class="math notranslate nohighlight">\( \frac{T_2}{T_1} \)</span> back into Equation <a class="reference internal" href="#equation-eq-continuity-area-ratio">(12)</a>, we can obtain a final expression for the area ratio between two locations as a function of the Mach numbers at the locations, the specific heat ratio of the gas, and any entropy increase between the locations:</p>
<div class="math notranslate nohighlight" id="equation-eq-area-ratio-loss">
<span class="eqno">(15)<a class="headerlink" href="#equation-eq-area-ratio-loss" title="Permalink to this equation">Â¶</a></span>\[
\frac{A_2}{A_1} = \frac{M_1}{M_2} \left[ \frac{1 + \frac{\gamma-1}{2} M_2^2}{1 + \frac{\gamma-1}{2} M_1^2} \right]^{\frac{\gamma+1}{2(\gamma-1)}} e^{\Delta s/R} \;.
\]</div>
<p>Combining Equation <a class="reference internal" href="#equation-eq-area-ratio-loss">(15)</a> with <a class="reference internal" href="#equation-eq-pressure-ratio">(14)</a> and <a class="reference internal" href="#equation-eq-temperature-ratio">(13)</a>, along with the stagnation relationships</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{gather*}
T_{t2} = T_{t1} \\
\frac{p_{t2}}{p_{t1}} = e^{-\Delta s / R} \;,
\end{gather*}
\end{split}\]</div>
<p>we have relationships between properties at two locations in any steady, one-dimensional flow with varying area, as long as there is no heat transfer or shaft work. We could also combine Equations <a class="reference internal" href="#equation-eq-pressure-ratio">(14)</a> and <a class="reference internal" href="#equation-eq-temperature-ratio">(13)</a> with the ideal gas law to get a density ratio:</p>
<div class="math notranslate nohighlight" id="equation-eq-density-ratio">
<span class="eqno">(16)<a class="headerlink" href="#equation-eq-density-ratio" title="Permalink to this equation">Â¶</a></span>\[
\frac{\rho_2}{\rho_1} = \left[ \frac{1 + \frac{\gamma - 1}{2} M_1^2}{1 + \frac{\gamma - 1}{2} M_2^2} \right]^{1 /(\gamma-1)} e^{-\Delta s / R} \;.
\]</div>
</div>
<div class="section" id="sonic-reference-state">
<h2>Sonic reference state<a class="headerlink" href="#sonic-reference-state" title="Permalink to this headline">Â¶</a></h2>
<p>If we know the Mach numbers at two locations, it is pretty easy to find the associated ratios of area, temperature, pressure, and/or density using Equations <a class="reference internal" href="#equation-eq-temperature-ratio">(13)</a> through <a class="reference internal" href="#equation-eq-density-ratio">(16)</a>.</p>
<p>However, if we instead know the area ratio or the properties at the two locations, plus one Mach number, and want to find the unknown Mach number, these equations are a bit tougher to solve. We <em>can</em> solve them directly using numerical methods, as you will see in a bit, but we can also take advantage of a helpful concept to ease the calculations.</p>
<p>Similar to the stagnation reference state, or the state associated with decelerating a fluid flow to rest and zero potential, isentropically, we can introduce the <strong>sonic reference state</strong>, indicated using a * superscript. This is the state associated with either decelerating or accelerating a fluid to sonic velocity (i.e., Mach = 1.0) by some process; currently, that will be through isentropic area change.</p>
<p>This reference state may not physically exist in the system, but <em>could</em> through appropriate area change. As a result, they are legitimate locations
in a flow system, and so we can use all of our developed equations to consider flow from a real location to this reference location.</p>
<p>In particular, we can write Equation <a class="reference internal" href="#equation-eq-area-ratio-loss">(15)</a> between the reference locations associated with two real locations: <span class="math notranslate nohighlight">\( A_1 \)</span> and <span class="math notranslate nohighlight">\( A_1^* \)</span>,
then <span class="math notranslate nohighlight">\( A_2 \)</span> and <span class="math notranslate nohighlight">\( A_2^* \)</span>. By definition, the Mach numbers are 1 at the two reference states. So, the area ratio equation becomes:</p>
<div class="math notranslate nohighlight" id="equation-eq-reference-area-ratio">
<span class="eqno">(17)<a class="headerlink" href="#equation-eq-reference-area-ratio" title="Permalink to this equation">Â¶</a></span>\[
\frac{A_2^*}{A_1^*} = e^{\Delta s / R} \;.
\]</div>
<p>This equation expresses how the area associated with reference state changes in a flow system in the presence of losses;
for isentropic flow, the reference area <span class="math notranslate nohighlight">\( A^* \)</span> remains constant.</p>
<p>Recall our relationship for the stagnation pressure ratio between two locations:</p>
<div class="math notranslate nohighlight">
\[
\frac{p_{t2}}{p_{t1}} = e^{-\Delta s / R} \;.
\]</div>
<p>If we take the product of these two equations, we get</p>
<div class="math notranslate nohighlight" id="equation-eq-pressure-area-product">
<span class="eqno">(18)<a class="headerlink" href="#equation-eq-pressure-area-product" title="Permalink to this equation">Â¶</a></span>\[
p_{t1} A_1^* = p_{t2} A_2^* \;,
\]</div>
<p>which gives us a quantity that is conserved in any adiabatic flow.</p>
</div>
<div class="section" id="isentropic-relations">
<h2>Isentropic relations<a class="headerlink" href="#isentropic-relations" title="Permalink to this headline">Â¶</a></h2>
<p>For isentropic flows, where <span class="math notranslate nohighlight">\(\Delta s = 0\)</span>, Equation <a class="reference internal" href="#equation-eq-area-ratio-loss">(15)</a> reduces to</p>
<div class="math notranslate nohighlight" id="equation-eq-area-ratio-isentropic">
<span class="eqno">(19)<a class="headerlink" href="#equation-eq-area-ratio-isentropic" title="Permalink to this equation">Â¶</a></span>\[
\frac{A_2}{A_1} = \frac{M_1}{M_2} \left( \frac{1+\frac{\gamma-1}{2} M_2^2}{1+\frac{\gamma-1}{2} M_1^2} \right)^{\frac{\gamma+1}{2(\gamma-1)}} \;.
\]</div>
<p>If we have <span class="math notranslate nohighlight">\(M_1\)</span> and <span class="math notranslate nohighlight">\(M_2\)</span>, and know the ideal gas (and therefore <span class="math notranslate nohighlight">\(\gamma\)</span>) then finding the area ratio between two sections is straightforward using the equation.
Working backwards takes slightly more effort, since the equation cannot simply be inverted.</p>
<p>Instead, it either needs to be solved numerically using a root-finding algorithm, <em>or</em> we can take advantage of the * (sonic) reference state to provide an easy way to solve problems.</p>
<p>Letâ€™s apply Equation <a class="reference internal" href="#equation-eq-area-ratio-isentropic">(19)</a> between any point in the flow and its sonic reference state, such that <span class="math notranslate nohighlight">\(A_2 \rightarrow A\)</span> (so <span class="math notranslate nohighlight">\(M_2 \rightarrow M\)</span>) and <span class="math notranslate nohighlight">\(A_1 \rightarrow A^*\)</span> (and <span class="math notranslate nohighlight">\(M_1 \rightarrow 1\)</span>):</p>
<div class="math notranslate nohighlight" id="equation-eq-ref-area-ratio">
<span class="eqno">(20)<a class="headerlink" href="#equation-eq-ref-area-ratio" title="Permalink to this equation">Â¶</a></span>\[
\frac{A}{A^*} = \frac{1}{M} \left( \frac{1+\frac{\gamma-1}{2} M^2}{\frac{\gamma+1}{2}} \right)^{\frac{\gamma+1}{2(\gamma-1)}} \;,
\]</div>
<p>which shows that <span class="math notranslate nohighlight">\(\frac{A}{A^*} = f(\gamma, M)\)</span>.
For a given value of <span class="math notranslate nohighlight">\(\gamma\)</span> (such as 1.4, used for air), it is easy to precalculate and tabulate the reference area ratio vs. values of Mach number.
Similarly, the quantities <span class="math notranslate nohighlight">\(p/p_t\)</span>, <span class="math notranslate nohighlight">\(T/T_t\)</span>, and <span class="math notranslate nohighlight">\(pA/p_t A^*\)</span> can be tabulated as well:</p>
<div class="math notranslate nohighlight" id="equation-eq-stag-pressure-ratio">
<span class="eqno">(21)<a class="headerlink" href="#equation-eq-stag-pressure-ratio" title="Permalink to this equation">Â¶</a></span>\[
\frac{p}{p_t} = \left(1 + \frac{\gamma-1}{2} M^2 \right)^{-\gamma/(\gamma-1)}
\]</div>
<div class="math notranslate nohighlight" id="equation-eq-stag-temperature-ratio">
<span class="eqno">(22)<a class="headerlink" href="#equation-eq-stag-temperature-ratio" title="Permalink to this equation">Â¶</a></span>\[
\frac{T}{T_t} = \left(1 + \frac{\gamma-1}{2} M^2 \right)^{-1}
\]</div>
<p>For example, letâ€™s tabulate the values from <span class="math notranslate nohighlight">\(M = \)</span> 0 to 0.3:</p>
<div class="cell tag_output_scroll docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gamma</span> <span class="o">=</span> <span class="mf">1.4</span>
<span class="n">machs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.31</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">)</span>
<span class="c1"># hiding divide by zero warning</span>
<span class="k">with</span> <span class="n">np</span><span class="o">.</span><span class="n">errstate</span><span class="p">(</span><span class="n">divide</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">):</span>
    <span class="n">area_ratios</span> <span class="o">=</span> <span class="p">(</span>
        <span class="p">(</span><span class="mf">1.0</span><span class="o">/</span><span class="n">machs</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">gamma</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">machs</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">gamma</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">gamma</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">gamma</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
        <span class="p">)</span>
<span class="n">pressure_ratios</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.0</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">gamma</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">machs</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="n">gamma</span><span class="o">/</span><span class="p">(</span><span class="n">gamma</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
<span class="n">temperature_ratios</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">gamma</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">machs</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="sa">r</span><span class="s1">&#39;$M$&#39;</span><span class="p">:</span> <span class="n">machs</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$p/p_t$&#39;</span><span class="p">:</span> <span class="n">pressure_ratios</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$T/T_t$&#39;</span><span class="p">:</span> <span class="n">temperature_ratios</span><span class="p">,</span>
    <span class="sa">r</span><span class="s1">&#39;$A/A^*$&#39;</span><span class="p">:</span> <span class="n">area_ratios</span>
    <span class="p">})</span>
<span class="n">df</span><span class="o">.</span><span class="n">style</span><span class="o">.</span>\
    <span class="n">hide_index</span><span class="p">()</span><span class="o">.</span>\
    <span class="nb">format</span><span class="p">(</span><span class="n">formatter</span><span class="o">=</span><span class="p">{(</span><span class="sa">r</span><span class="s1">&#39;$M$&#39;</span><span class="p">):</span> <span class="s2">&quot;</span><span class="si">{:.2f}</span><span class="s2">&quot;</span><span class="p">})</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style type="text/css">
</style>
<table id="T_23d61_">
  <thead>
    <tr>
      <th class="col_heading level0 col0" >$M$</th>
      <th class="col_heading level0 col1" >$p/p_t$</th>
      <th class="col_heading level0 col2" >$T/T_t$</th>
      <th class="col_heading level0 col3" >$A/A^*$</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td id="T_23d61_row0_col0" class="data row0 col0" >0.00</td>
      <td id="T_23d61_row0_col1" class="data row0 col1" >1.000000</td>
      <td id="T_23d61_row0_col2" class="data row0 col2" >1.000000</td>
      <td id="T_23d61_row0_col3" class="data row0 col3" >inf</td>
    </tr>
    <tr>
      <td id="T_23d61_row1_col0" class="data row1 col0" >0.01</td>
      <td id="T_23d61_row1_col1" class="data row1 col1" >0.999930</td>
      <td id="T_23d61_row1_col2" class="data row1 col2" >0.999980</td>
      <td id="T_23d61_row1_col3" class="data row1 col3" >57.873843</td>
    </tr>
    <tr>
      <td id="T_23d61_row2_col0" class="data row2 col0" >0.02</td>
      <td id="T_23d61_row2_col1" class="data row2 col1" >0.999720</td>
      <td id="T_23d61_row2_col2" class="data row2 col2" >0.999920</td>
      <td id="T_23d61_row2_col3" class="data row2 col3" >28.942130</td>
    </tr>
    <tr>
      <td id="T_23d61_row3_col0" class="data row3 col0" >0.03</td>
      <td id="T_23d61_row3_col1" class="data row3 col1" >0.999370</td>
      <td id="T_23d61_row3_col2" class="data row3 col2" >0.999820</td>
      <td id="T_23d61_row3_col3" class="data row3 col3" >19.300542</td>
    </tr>
    <tr>
      <td id="T_23d61_row4_col0" class="data row4 col0" >0.04</td>
      <td id="T_23d61_row4_col1" class="data row4 col1" >0.998881</td>
      <td id="T_23d61_row4_col2" class="data row4 col2" >0.999680</td>
      <td id="T_23d61_row4_col3" class="data row4 col3" >14.481486</td>
    </tr>
    <tr>
      <td id="T_23d61_row5_col0" class="data row5 col0" >0.05</td>
      <td id="T_23d61_row5_col1" class="data row5 col1" >0.998252</td>
      <td id="T_23d61_row5_col2" class="data row5 col2" >0.999500</td>
      <td id="T_23d61_row5_col3" class="data row5 col3" >11.591444</td>
    </tr>
    <tr>
      <td id="T_23d61_row6_col0" class="data row6 col0" >0.06</td>
      <td id="T_23d61_row6_col1" class="data row6 col1" >0.997484</td>
      <td id="T_23d61_row6_col2" class="data row6 col2" >0.999281</td>
      <td id="T_23d61_row6_col3" class="data row6 col3" >9.665910</td>
    </tr>
    <tr>
      <td id="T_23d61_row7_col0" class="data row7 col0" >0.07</td>
      <td id="T_23d61_row7_col1" class="data row7 col1" >0.996578</td>
      <td id="T_23d61_row7_col2" class="data row7 col2" >0.999021</td>
      <td id="T_23d61_row7_col3" class="data row7 col3" >8.291525</td>
    </tr>
    <tr>
      <td id="T_23d61_row8_col0" class="data row8 col0" >0.08</td>
      <td id="T_23d61_row8_col1" class="data row8 col1" >0.995533</td>
      <td id="T_23d61_row8_col2" class="data row8 col2" >0.998722</td>
      <td id="T_23d61_row8_col3" class="data row8 col3" >7.261610</td>
    </tr>
    <tr>
      <td id="T_23d61_row9_col0" class="data row9 col0" >0.09</td>
      <td id="T_23d61_row9_col1" class="data row9 col1" >0.994351</td>
      <td id="T_23d61_row9_col2" class="data row9 col2" >0.998383</td>
      <td id="T_23d61_row9_col3" class="data row9 col3" >6.461342</td>
    </tr>
    <tr>
      <td id="T_23d61_row10_col0" class="data row10 col0" >0.10</td>
      <td id="T_23d61_row10_col1" class="data row10 col1" >0.993031</td>
      <td id="T_23d61_row10_col2" class="data row10 col2" >0.998004</td>
      <td id="T_23d61_row10_col3" class="data row10 col3" >5.821829</td>
    </tr>
    <tr>
      <td id="T_23d61_row11_col0" class="data row11 col0" >0.11</td>
      <td id="T_23d61_row11_col1" class="data row11 col1" >0.991576</td>
      <td id="T_23d61_row11_col2" class="data row11 col2" >0.997586</td>
      <td id="T_23d61_row11_col3" class="data row11 col3" >5.299230</td>
    </tr>
    <tr>
      <td id="T_23d61_row12_col0" class="data row12 col0" >0.12</td>
      <td id="T_23d61_row12_col1" class="data row12 col1" >0.989985</td>
      <td id="T_23d61_row12_col2" class="data row12 col2" >0.997128</td>
      <td id="T_23d61_row12_col3" class="data row12 col3" >4.864318</td>
    </tr>
    <tr>
      <td id="T_23d61_row13_col0" class="data row13 col0" >0.13</td>
      <td id="T_23d61_row13_col1" class="data row13 col1" >0.988259</td>
      <td id="T_23d61_row13_col2" class="data row13 col2" >0.996631</td>
      <td id="T_23d61_row13_col3" class="data row13 col3" >4.496859</td>
    </tr>
    <tr>
      <td id="T_23d61_row14_col0" class="data row14 col0" >0.14</td>
      <td id="T_23d61_row14_col1" class="data row14 col1" >0.986400</td>
      <td id="T_23d61_row14_col2" class="data row14 col2" >0.996095</td>
      <td id="T_23d61_row14_col3" class="data row14 col3" >4.182400</td>
    </tr>
    <tr>
      <td id="T_23d61_row15_col0" class="data row15 col0" >0.15</td>
      <td id="T_23d61_row15_col1" class="data row15 col1" >0.984408</td>
      <td id="T_23d61_row15_col2" class="data row15 col2" >0.995520</td>
      <td id="T_23d61_row15_col3" class="data row15 col3" >3.910343</td>
    </tr>
    <tr>
      <td id="T_23d61_row16_col0" class="data row16 col0" >0.16</td>
      <td id="T_23d61_row16_col1" class="data row16 col1" >0.982285</td>
      <td id="T_23d61_row16_col2" class="data row16 col2" >0.994906</td>
      <td id="T_23d61_row16_col3" class="data row16 col3" >3.672739</td>
    </tr>
    <tr>
      <td id="T_23d61_row17_col0" class="data row17 col0" >0.17</td>
      <td id="T_23d61_row17_col1" class="data row17 col1" >0.980030</td>
      <td id="T_23d61_row17_col2" class="data row17 col2" >0.994253</td>
      <td id="T_23d61_row17_col3" class="data row17 col3" >3.463509</td>
    </tr>
    <tr>
      <td id="T_23d61_row18_col0" class="data row18 col0" >0.18</td>
      <td id="T_23d61_row18_col1" class="data row18 col1" >0.977647</td>
      <td id="T_23d61_row18_col2" class="data row18 col2" >0.993562</td>
      <td id="T_23d61_row18_col3" class="data row18 col3" >3.277926</td>
    </tr>
    <tr>
      <td id="T_23d61_row19_col0" class="data row19 col0" >0.19</td>
      <td id="T_23d61_row19_col1" class="data row19 col1" >0.975135</td>
      <td id="T_23d61_row19_col2" class="data row19 col2" >0.992832</td>
      <td id="T_23d61_row19_col3" class="data row19 col3" >3.112259</td>
    </tr>
    <tr>
      <td id="T_23d61_row20_col0" class="data row20 col0" >0.20</td>
      <td id="T_23d61_row20_col1" class="data row20 col1" >0.972497</td>
      <td id="T_23d61_row20_col2" class="data row20 col2" >0.992063</td>
      <td id="T_23d61_row20_col3" class="data row20 col3" >2.963520</td>
    </tr>
    <tr>
      <td id="T_23d61_row21_col0" class="data row21 col0" >0.21</td>
      <td id="T_23d61_row21_col1" class="data row21 col1" >0.969733</td>
      <td id="T_23d61_row21_col2" class="data row21 col2" >0.991257</td>
      <td id="T_23d61_row21_col3" class="data row21 col3" >2.829294</td>
    </tr>
    <tr>
      <td id="T_23d61_row22_col0" class="data row22 col0" >0.22</td>
      <td id="T_23d61_row22_col1" class="data row22 col1" >0.966845</td>
      <td id="T_23d61_row22_col2" class="data row22 col2" >0.990413</td>
      <td id="T_23d61_row22_col3" class="data row22 col3" >2.707602</td>
    </tr>
    <tr>
      <td id="T_23d61_row23_col0" class="data row23 col0" >0.23</td>
      <td id="T_23d61_row23_col1" class="data row23 col1" >0.963835</td>
      <td id="T_23d61_row23_col2" class="data row23 col2" >0.989531</td>
      <td id="T_23d61_row23_col3" class="data row23 col3" >2.596812</td>
    </tr>
    <tr>
      <td id="T_23d61_row24_col0" class="data row24 col0" >0.24</td>
      <td id="T_23d61_row24_col1" class="data row24 col1" >0.960703</td>
      <td id="T_23d61_row24_col2" class="data row24 col2" >0.988611</td>
      <td id="T_23d61_row24_col3" class="data row24 col3" >2.495562</td>
    </tr>
    <tr>
      <td id="T_23d61_row25_col0" class="data row25 col0" >0.25</td>
      <td id="T_23d61_row25_col1" class="data row25 col1" >0.957453</td>
      <td id="T_23d61_row25_col2" class="data row25 col2" >0.987654</td>
      <td id="T_23d61_row25_col3" class="data row25 col3" >2.402710</td>
    </tr>
    <tr>
      <td id="T_23d61_row26_col0" class="data row26 col0" >0.26</td>
      <td id="T_23d61_row26_col1" class="data row26 col1" >0.954085</td>
      <td id="T_23d61_row26_col2" class="data row26 col2" >0.986660</td>
      <td id="T_23d61_row26_col3" class="data row26 col3" >2.317287</td>
    </tr>
    <tr>
      <td id="T_23d61_row27_col0" class="data row27 col0" >0.27</td>
      <td id="T_23d61_row27_col1" class="data row27 col1" >0.950600</td>
      <td id="T_23d61_row27_col2" class="data row27 col2" >0.985630</td>
      <td id="T_23d61_row27_col3" class="data row27 col3" >2.238471</td>
    </tr>
    <tr>
      <td id="T_23d61_row28_col0" class="data row28 col0" >0.28</td>
      <td id="T_23d61_row28_col1" class="data row28 col1" >0.947002</td>
      <td id="T_23d61_row28_col2" class="data row28 col2" >0.984562</td>
      <td id="T_23d61_row28_col3" class="data row28 col3" >2.165554</td>
    </tr>
    <tr>
      <td id="T_23d61_row29_col0" class="data row29 col0" >0.29</td>
      <td id="T_23d61_row29_col1" class="data row29 col1" >0.943291</td>
      <td id="T_23d61_row29_col2" class="data row29 col2" >0.983458</td>
      <td id="T_23d61_row29_col3" class="data row29 col3" >2.097928</td>
    </tr>
    <tr>
      <td id="T_23d61_row30_col0" class="data row30 col0" >0.30</td>
      <td id="T_23d61_row30_col1" class="data row30 col1" >0.939470</td>
      <td id="T_23d61_row30_col2" class="data row30 col2" >0.982318</td>
      <td id="T_23d61_row30_col3" class="data row30 col3" >2.035065</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>With tabulated data like this, we can then solve problems by constructing an appropriate property ratio based on known information and looking up the corresponding Mach number.</p>
<p>For example, given a gas (<span class="math notranslate nohighlight">\(\gamma\)</span>), the areas at two locations (<span class="math notranslate nohighlight">\(A_1\)</span> and <span class="math notranslate nohighlight">\(A_2\)</span>), and the Mach number at one location (<span class="math notranslate nohighlight">\(M_1\)</span>), we can find the Mach number at the second location (<span class="math notranslate nohighlight">\(M_2\)</span>) by constructing the reference area ratio:</p>
<div class="math notranslate nohighlight">
\[
\frac{A_2}{A_2^*} = \frac{A_2}{A_1} \frac{A_1}{A_1^*} \frac{A_1^*}{A_2^*} \;,
\]</div>
<p>where <span class="math notranslate nohighlight">\(\frac{A_2}{A_2^*} = f(M_2)\)</span>, <span class="math notranslate nohighlight">\(\frac{A_2}{A_1}\)</span> is known, <span class="math notranslate nohighlight">\(\frac{A_1}{A_1^*} = f(M_1)\)</span>, and <span class="math notranslate nohighlight">\(\frac{A_1^*}{A_2^*} = 1.0\)</span> for isentropic flow between the two sections.
So, we can find <span class="math notranslate nohighlight">\(M_2\)</span>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For a given area ratio <span class="math notranslate nohighlight">\(\frac{A}{A^*}\)</span>, there will always be <strong>two</strong> possible Mach numbers: a subsonic solution and a supersonic solution.</p>
</div>
<p>To determine which Mach number is the correct solution, you need to apply other knowledge and problem context. For example, if the initial Mach number is subsonic and the two sections are only connected by a diverging or converging area duct, then the second Mach number must also be subsonic.</p>
</div>
<div class="section" id="example-isentropic-flow-problem">
<h2>Example: isentropic flow problem<a class="headerlink" href="#example-isentropic-flow-problem" title="Permalink to this headline">Â¶</a></h2>
<p><strong>Problem:</strong> Air flows isentropically through a duct (<span class="math notranslate nohighlight">\(\gamma = 1.4\)</span>) where the area is changing from point 1 to 2,
with no heat transfer or shaft work. The area ratio is <span class="math notranslate nohighlight">\(\frac{A_2}{A_1} = 2.5\)</span>, the flow starts at <span class="math notranslate nohighlight">\(M_1 = 0.5\)</span> and 4 bar.
Find the Mach number and pressure at the second point in the duct.</p>
<p>We can solve this using the classical approach (pre-calculated isentropic tables) or a numerical approach;
both follow the same general approach:</p>
<ol class="simple">
<li><p>Find <span class="math notranslate nohighlight">\(M_2\)</span> associated with the area ratio <span class="math notranslate nohighlight">\(A_2 / A_2^*\)</span>, then</p></li>
<li><p>Use that to find the stagnation pressure ratio <span class="math notranslate nohighlight">\(p_2 / p_{t2}\)</span>.</p></li>
</ol>
<div class="math notranslate nohighlight">
\[
\frac{A_2}{A_2^*} = \frac{A_2}{A_1} \frac{A_1}{A_1^*} \frac{A_1^*}{A_2^*} \;,
\]</div>
<p>where <span class="math notranslate nohighlight">\(\frac{A_2}{A_1} = 2.5\)</span> is given, we can find <span class="math notranslate nohighlight">\(\frac{A_1}{A_1^*}\)</span> using</p>
<div class="math notranslate nohighlight">
\[
\frac{A}{A^*} = \frac{1}{M} \left( \frac{1 + \frac{\gamma - 1}{2} M^2}{\frac{\gamma+1}{2}} \right)^{\frac{\gamma+1}{2(\gamma-1)}} \;,
\]</div>
<p>(either by calculating or looking up in the <span class="math notranslate nohighlight">\(\gamma = 1.4\)</span> table)
and <span class="math notranslate nohighlight">\(\frac{A_1^*}{A_2^*} = 1\)</span> because the flow is isentropic.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gamma</span> <span class="o">=</span> <span class="mf">1.4</span>
<span class="n">mach_1</span> <span class="o">=</span> <span class="mf">0.5</span>

<span class="n">A2_A1</span> <span class="o">=</span> <span class="mf">2.5</span>
<span class="n">A1star_A2star</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="c1"># isentropic</span>

<span class="n">A1_A1star</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.0</span><span class="o">/</span><span class="n">mach_1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span>
    <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">gamma</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">mach_1</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="p">((</span><span class="n">gamma</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
    <span class="p">)</span><span class="o">**</span><span class="p">((</span><span class="n">gamma</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">gamma</span><span class="o">-</span><span class="mi">1</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;A1/A1^* = </span><span class="si">{</span><span class="n">A1_A1star</span><span class="si">:</span><span class="s1">.4f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A1/A1^* = 1.3398
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A2_A2star</span> <span class="o">=</span> <span class="n">A2_A1</span> <span class="o">*</span> <span class="n">A1_A1star</span> <span class="o">*</span> <span class="n">A1star_A2star</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;A2/A2star = </span><span class="si">{</span><span class="n">A2_A2star</span><span class="si">:</span><span class="s1">.4f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A2/A2star = 3.3496
</pre></div>
</div>
</div>
</div>
<p>We can then find <span class="math notranslate nohighlight">\(M_2\)</span>, because <span class="math notranslate nohighlight">\(\frac{A_2}{A_2*} = f(M_2)\)</span>.
Our options are to use the <span class="math notranslate nohighlight">\(\gamma = 1.4\)</span> tables and interpolate, or solve the associated equation numerically.</p>
<div class="section" id="option-1-using-tables">
<h3>Option 1: using tables<a class="headerlink" href="#option-1-using-tables" title="Permalink to this headline">Â¶</a></h3>
<p>We can find in the tables that:</p>
<ul class="simple">
<li><p>at <span class="math notranslate nohighlight">\(M=0.17\)</span>, <span class="math notranslate nohighlight">\(A/A^* = 3.46351\)</span></p></li>
<li><p>at <span class="math notranslate nohighlight">\(M = 0.18\)</span>, <span class="math notranslate nohighlight">\(A/A^* = 3.27793\)</span></p></li>
</ul>
<p>and interpolate to find the precise <span class="math notranslate nohighlight">\(M_2\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">machs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.17</span><span class="p">,</span> <span class="mf">0.18</span><span class="p">])</span>
<span class="n">areas</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">3.46351</span><span class="p">,</span> <span class="mf">3.27793</span><span class="p">])</span>
<span class="n">mach_2</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">machs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">areas</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">A2_A2star</span><span class="p">)</span> <span class="o">+</span> <span class="n">machs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">A2_A2star</span> <span class="o">-</span> <span class="n">areas</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">areas</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">areas</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;M2 = </span><span class="si">{</span><span class="n">mach_2</span><span class="si">:</span><span class="s1">.4f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>M2 = 0.1761
</pre></div>
</div>
</div>
</div>
<p>This is probably sufficient, but we could get a more-accurate result by interpolating using more points and using the <code class="docutils literal notranslate"><span class="pre">numpy.interp()</span></code> function:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">machs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.15</span><span class="p">,</span> <span class="mf">0.16</span><span class="p">,</span> <span class="mf">0.17</span><span class="p">,</span> <span class="mf">0.18</span><span class="p">,</span> <span class="mf">0.19</span><span class="p">])</span>
<span class="n">areas</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">3.91034</span><span class="p">,</span> <span class="mf">3.67274</span><span class="p">,</span> <span class="mf">3.46351</span><span class="p">,</span> <span class="mf">3.27793</span><span class="p">,</span> <span class="mf">3.11226</span><span class="p">])</span>

<span class="n">mach_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">A2_A2star</span><span class="p">,</span> <span class="n">areas</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">machs</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;M2 = </span><span class="si">{</span><span class="n">mach_2</span><span class="si">:</span><span class="s1">.4f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>M2 = 0.1761
</pre></div>
</div>
</div>
</div>
<p>Note that we have to reverse the order of the values, since <code class="docutils literal notranslate"><span class="pre">interp</span></code> expects the x-values to be increasing.
Also, we could easily generate these values ourselves for a different value of <span class="math notranslate nohighlight">\(\gamma\)</span>, but it is likely
easier to just solve the equation directly in that case</p>
</div>
<div class="section" id="option-2-solving-the-equation">
<h3>Option 2: solving the equation<a class="headerlink" href="#option-2-solving-the-equation" title="Permalink to this headline">Â¶</a></h3>
<p>Alternately, we can solve the <span class="math notranslate nohighlight">\(\frac{A_2}{A_2*} = f(M_2, \gamma)\)</span> equation directly using <code class="docutils literal notranslate"><span class="pre">scipy.optimize.root_scalar</span></code>. We need to give the function initial guesses <code class="docutils literal notranslate"><span class="pre">x0</span></code> and <code class="docutils literal notranslate"><span class="pre">x1</span></code> that are subsonic, to ensure we get a subsonic solution.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">area_function</span><span class="p">(</span><span class="n">mach</span><span class="p">,</span> <span class="n">gamma</span><span class="p">,</span> <span class="n">area_ratio</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Function for area ratio, solving for M2&#39;&#39;&#39;</span>
    <span class="k">return</span> <span class="p">(</span>
        <span class="n">area_ratio</span> <span class="o">-</span> <span class="p">(</span>
            <span class="p">(</span><span class="mf">1.0</span><span class="o">/</span><span class="n">mach</span><span class="p">)</span> <span class="o">*</span> <span class="p">((</span><span class="mi">1</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">gamma</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">mach</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> 
            <span class="p">((</span><span class="n">gamma</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span><span class="o">**</span><span class="p">((</span><span class="n">gamma</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">gamma</span><span class="o">-</span><span class="mi">1</span><span class="p">)))</span>
            <span class="p">)</span>
        <span class="p">)</span>

<span class="n">sol</span> <span class="o">=</span> <span class="n">root_scalar</span><span class="p">(</span><span class="n">area_function</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">gamma</span><span class="p">,</span> <span class="n">A2_A2star</span><span class="p">),</span> <span class="n">x0</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">x1</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;M2 = </span><span class="si">{</span><span class="n">sol</span><span class="o">.</span><span class="n">root</span><span class="si">:</span><span class="s1">.4f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>M2 = 0.1760
</pre></div>
</div>
</div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Make sure you check the output from root-finding functions, because they can converge on the wrong solution even with an appropriate initial guess. You might need to adjust the initial guess if you get a solution that is not consistent with the physics of the problem.</p>
</div>
</div>
<div class="section" id="option-3-solving-the-full-equation">
<h3>Option 3: solving the full equation<a class="headerlink" href="#option-3-solving-the-full-equation" title="Permalink to this headline">Â¶</a></h3>
<p>As a third option, we could actually bypass the ratio approach and just numerically solve the full Equation <a class="reference internal" href="#equation-eq-area-ratio-loss">(15)</a> directly, using the known <span class="math notranslate nohighlight">\( A_2/A_1 \)</span>, <span class="math notranslate nohighlight">\( M_1 \)</span>, <span class="math notranslate nohighlight">\( \gamma \)</span>, and <span class="math notranslate nohighlight">\( \Delta s = 0 \)</span>!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">full_area_function</span><span class="p">(</span><span class="n">mach2</span><span class="p">,</span> <span class="n">mach1</span><span class="p">,</span> <span class="n">area_ratio</span><span class="p">,</span> <span class="n">gamma</span><span class="o">=</span><span class="mf">1.4</span><span class="p">,</span> <span class="n">delta_s</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">R</span><span class="o">=</span><span class="mf">287.0</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Function for full area ratio equation, solving for M2&#39;&#39;&#39;</span>
    <span class="c1"># gamma, delta_s, and R have default values</span>
    <span class="k">return</span> <span class="p">(</span>
        <span class="n">area_ratio</span> <span class="o">-</span> <span class="p">(</span><span class="n">mach1</span> <span class="o">/</span> <span class="n">mach2</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span>
            <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">gamma</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">mach2</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">gamma</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">mach1</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
            <span class="p">)</span><span class="o">**</span><span class="p">((</span><span class="n">gamma</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">gamma</span><span class="o">-</span><span class="mi">1</span><span class="p">)))</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">delta_s</span> <span class="o">/</span> <span class="n">R</span><span class="p">)</span>
        <span class="p">)</span>

<span class="n">sol</span> <span class="o">=</span> <span class="n">root_scalar</span><span class="p">(</span><span class="n">full_area_function</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">mach_1</span><span class="p">,</span> <span class="n">A2_A1</span><span class="p">,</span> <span class="n">gamma</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span> <span class="n">x0</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">x1</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;M2 = </span><span class="si">{</span><span class="n">sol</span><span class="o">.</span><span class="n">root</span><span class="si">:</span><span class="s1">.4f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>M2 = 0.1760
</pre></div>
</div>
</div>
</div>
<p>This approach is the most direct.</p>
</div>
</div>
<div class="section" id="example-isentropic-flow-using-matlab">
<h2>Example: isentropic flow (using Matlab)<a class="headerlink" href="#example-isentropic-flow-using-matlab" title="Permalink to this headline">Â¶</a></h2>
<p>If you prefer to use Matlab, we can also solve the same example using the three different strategies.</p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="nb">gamma</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">1.4</span><span class="p">;</span><span class="w"></span>
<span class="n">mach_1</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">0.5</span><span class="p">;</span><span class="w"></span>

<span class="n">A2_A1</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">2.5</span><span class="p">;</span><span class="w"></span>
<span class="n">A1star_A2star</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">1.0</span><span class="p">;</span><span class="w"></span>

<span class="n">A1_A1star</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">(</span><span class="mf">1.0</span><span class="o">/</span><span class="n">mach_1</span><span class="p">)</span><span class="o">*</span><span class="p">((</span><span class="mi">1</span><span class="o">+</span><span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="nb">gamma</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">mach_1</span>^<span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="p">((</span><span class="nb">gamma</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span>^<span class="p">((</span><span class="nb">gamma</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="nb">gamma</span><span class="o">-</span><span class="mi">1</span><span class="p">)));</span><span class="w"></span>
<span class="nb">fprintf</span><span class="p">(</span><span class="s">&#39;A1/A1^* = %.4f\n&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">A1_A1star</span><span class="p">)</span><span class="w"></span>

<span class="n">A2_A2star</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">A2_A1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">A1_A1star</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">A1star_A2star</span><span class="p">;</span><span class="w"></span>
<span class="nb">fprintf</span><span class="p">(</span><span class="s">&#39;A2/A2star = %.4f\n&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">A2_A2star</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>A1/A1^* = 1.3398
A2/A2star = 3.3496
</pre></div>
</div>
<div class="section" id="option-1-using-the-tables">
<h3>Option 1: using the tables<a class="headerlink" href="#option-1-using-the-tables" title="Permalink to this headline">Â¶</a></h3>
<p>We find in the tables that:</p>
<ul class="simple">
<li><p>at <span class="math notranslate nohighlight">\(M=0.17\)</span>, <span class="math notranslate nohighlight">\(A/A^* = 3.46351\)</span></p></li>
<li><p>at <span class="math notranslate nohighlight">\(M = 0.18\)</span>, <span class="math notranslate nohighlight">\(A/A^* = 3.27793\)</span></p></li>
</ul>
<p>and linearly interpolate to find the precise <span class="math notranslate nohighlight">\(M_2\)</span>:</p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">machs</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[</span><span class="mf">0.17</span><span class="p">,</span><span class="w"> </span><span class="mf">0.18</span><span class="p">];</span><span class="w"></span>
<span class="n">areas</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[</span><span class="mf">3.46351</span><span class="p">,</span><span class="w"> </span><span class="mf">3.27793</span><span class="p">];</span><span class="w"></span>
<span class="n">mach_2</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">(</span><span class="n">machs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">areas</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">-</span><span class="n">A2_A2star</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">machs</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">A2_A2star</span><span class="o">-</span><span class="n">areas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span><span class="o">/</span><span class="p">(</span><span class="n">areas</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">-</span><span class="n">areas</span><span class="p">(</span><span class="mi">1</span><span class="p">));</span><span class="w"></span>
<span class="nb">fprintf</span><span class="p">(</span><span class="s">&#39;M2 = %.4f\n&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">mach_2</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>M2 = 0.1761
</pre></div>
</div>
<p>We can also use Matlabâ€™s built-in <code class="docutils literal notranslate"><span class="pre">interp1</span></code> function to interpolate with more data points:</p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">machs</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[</span><span class="mf">0.15</span><span class="p">,</span><span class="w"> </span><span class="mf">0.16</span><span class="p">,</span><span class="w"> </span><span class="mf">0.17</span><span class="p">,</span><span class="w"> </span><span class="mf">0.18</span><span class="p">,</span><span class="w"> </span><span class="mf">0.19</span><span class="p">];</span><span class="w"></span>
<span class="n">areas</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[</span><span class="mf">3.91034</span><span class="p">,</span><span class="w"> </span><span class="mf">3.67274</span><span class="p">,</span><span class="w"> </span><span class="mf">3.46351</span><span class="p">,</span><span class="w"> </span><span class="mf">3.27793</span><span class="p">,</span><span class="w"> </span><span class="mf">3.11226</span><span class="p">];</span><span class="w"></span>

<span class="n">mach_2</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">interp1</span><span class="p">(</span><span class="n">areas</span><span class="p">,</span><span class="w"> </span><span class="n">machs</span><span class="p">,</span><span class="w"> </span><span class="n">A2_A2star</span><span class="p">);</span><span class="w"></span>
<span class="nb">fprintf</span><span class="p">(</span><span class="s">&#39;M2 = %.4f\n&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">mach_2</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>M2 = 0.1761
</pre></div>
</div>
</div>
<div class="section" id="id1">
<h3>Option 2: solving the equation<a class="headerlink" href="#id1" title="Permalink to this headline">Â¶</a></h3>
<p>Alternately, we can solve the <span class="math notranslate nohighlight">\(\frac{A_2}{A_2*} = f(M_2, \gamma)\)</span> equation directly using the function <code class="docutils literal notranslate"><span class="pre">fzero</span></code>:</p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">@(</span><span class="n">M</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="n">A2_A2star</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">((</span><span class="mf">1.0</span><span class="o">/</span><span class="n">M</span><span class="p">)</span><span class="o">*</span><span class="p">((</span><span class="mi">1</span><span class="o">+</span><span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="nb">gamma</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">M</span>^<span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">...</span><span class="w"></span>
<span class="w">    </span><span class="o">/</span><span class="w"> </span><span class="p">((</span><span class="nb">gamma</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span>^<span class="p">((</span><span class="nb">gamma</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="nb">gamma</span><span class="o">-</span><span class="mi">1</span><span class="p">)))));</span><span class="w"></span>

<span class="n">M2</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">fzero</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="w"> </span><span class="mf">0.1</span><span class="p">);</span><span class="w"></span>
<span class="nb">fprintf</span><span class="p">(</span><span class="s">&#39;M2 = %.4f\n&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">M2</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>M2 = 0.1760
</pre></div>
</div>
<p>Note that, in this example, the values of <span class="math notranslate nohighlight">\(\gamma\)</span> and <span class="math notranslate nohighlight">\(A_2 / A_2^*\)</span> are hard-coded into the function.</p>
</div>
<div class="section" id="id2">
<h3>Option 3: solving the full equation<a class="headerlink" href="#id2" title="Permalink to this headline">Â¶</a></h3>
<p>As a third option, we can bypass the ratio approach and just numerically solve the full Equation <a class="reference internal" href="#equation-eq-area-ratio-loss">(15)</a> directly, using the known <span class="math notranslate nohighlight">\( A_2/A_1 \)</span>, <span class="math notranslate nohighlight">\( M_1 \)</span>, <span class="math notranslate nohighlight">\( \gamma \)</span>, and <span class="math notranslate nohighlight">\( \Delta s = 0 \)</span>!</p>
<p>To do this, we create two functions: one that depends on all the variables, and a parameterized function that only depends on <span class="math notranslate nohighlight">\(M_2\)</span>.</p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">fun</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">@(</span><span class="n">M2</span><span class="p">,</span><span class="w"> </span><span class="n">M1</span><span class="p">,</span><span class="w"> </span><span class="n">A2_A1</span><span class="p">,</span><span class="w"> </span><span class="nb">gamma</span><span class="p">,</span><span class="w"> </span><span class="n">delta_s</span><span class="p">,</span><span class="w"> </span><span class="n">R</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="n">A2_A1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">(</span><span class="n">M1</span><span class="o">/</span><span class="n">M2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="w"> </span><span class="k">...</span><span class="w"></span>
<span class="w">      </span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="nb">gamma</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">M2</span>^<span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="nb">gamma</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">M1</span>^<span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">...</span><span class="w"></span>
<span class="w">            </span><span class="p">)</span>^<span class="p">((</span><span class="nb">gamma</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="nb">gamma</span><span class="o">-</span><span class="mi">1</span><span class="p">)))</span><span class="o">*</span><span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="n">delta_s</span><span class="o">/</span><span class="n">R</span><span class="p">));</span><span class="w"></span>

<span class="c">% parameterized function</span><span class="w"></span>
<span class="n">f</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">@(</span><span class="n">M2</span><span class="p">)</span><span class="w"> </span><span class="n">fun</span><span class="p">(</span><span class="n">M2</span><span class="p">,</span><span class="w"> </span><span class="n">mach_1</span><span class="p">,</span><span class="w"> </span><span class="n">A2_A1</span><span class="p">,</span><span class="w"> </span><span class="nb">gamma</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mi">287</span><span class="p">);</span><span class="w"></span>
<span class="n">M2</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">fzero</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="w"> </span><span class="mf">0.1</span><span class="p">);</span><span class="w"></span>
<span class="nb">fprintf</span><span class="p">(</span><span class="s">&#39;M2 = %.4f\n&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">M2</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>M2 = 0.1760
</pre></div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./compressible-flows"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
            



<div class='prev-next-bottom'>
    
    <div id="prev">
        <a class="left-prev" href="intro-compressible-flow.html" title="previous page">
            <i class="prevnext-label fas fa-angle-left"></i>
            <div class="prevnext-info">
                <p class="prevnext-label">previous</p>
                <p class="prevnext-title">Introduction to compressible flow</p>
            </div>
        </a>
    </div>
     <div id="next">
        <a class="right-next" href="nozzles-part1.html" title="next page">
            <div class="prevnext-info">
                <p class="prevnext-label">next</p>
                <p class="prevnext-title">Nozzles (part I)</p>
            </div>
            <i class="prevnext-label fas fa-angle-right"></i>
        </a>
     </div>

</div>
        
        </div>
    </div>
    <footer class="footer">
    <div class="container">
      <p>
        
          By Kyle Niemeyer<br/>
        
          <div class="extra_footer">
            <p xmlns:dct="http://purl.org/dc/terms/" xmlns:cc="http://creativecommons.org/ns#" class="license-text"><a rel="cc:attributionURL" property="dct:title" href="https://github.com/kyleniemeyer/gas-dynamics-notes">Gas Dynamics notes</a> by <span property="cc:attributionName">Kyle Niemeyer</span> is licensed under <a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0">CC BY-SA 4.0<img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/cc.svg?ref=chooser-v1" /><img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/by.svg?ref=chooser-v1" /><img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/sa.svg?ref=chooser-v1" /></a></p>

          </div>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>